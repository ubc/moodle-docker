{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    Page header.
}}

<header id="header" class="page-header page-header-top-bar navbar" role="banner">
	<div class="top-bar">
		<div class="container-fluid">
			<div class="top-bar-inner">
              
               <nav class="navbar fixed-top navbar-expand boost-navbar" aria-label="{{#str}}sitemenubar, admin{{/str}}">
		        
			       <div class="flex-wrapper d-flex align-items-center">
				        {{!--//header_dropdownmenu (theme class function)--}}
						{{{ output.header_dropdownmenu}}}
	
						{{!--//header_socialmedia (theme class function)--}}
						{{{ output.header_socialmedia}}}
						
					</div><!--//d-flex-->
					 
		           
		            <ul class="navbar-nav d-none d-md-flex my-1 px-1">
				        <!-- page_heading_menu -->
				        {{{ output.page_heading_menu }}}
				    </ul>
				
				    <div id="usernavigation" class="navbar-nav ml-auto">


<div class="divider border-left h-75 align-self-center mx-1"></div>

<div class="langmenu" style="width:120px; margin:10 auto;">
    <div class="dropdown show">
        <a href="#" role="button" id="lang-menu-toggle" data-toggle="dropdown" aria-label="Language" aria-haspopup="true" aria-controls="lang-action-menu" class="btn dropdown-toggle">
            <i class="icon fa fa-language fa-fw mr-1" aria-hidden="true"></i>
            <span class="langbutton">
                Language
            </span>
            <b class="caret"></b>
        </a>
        <div role="menu" aria-labelledby="lang-menu-toggle" id="lang-action-menu" class="dropdown-menu dropdown-menu-right">
                    <a id="dynamic-link-en" href="#" class="dropdown-item pl-5" lang="en">
                        English
                    </a>
                    <a id="dynamic-link-fr-ca" href="#" class="dropdown-item pl-5" role="menuitem" lang="fr_ca">
                        Français (Canada)
                    </a>
        </div>
    </div>
</div>



<div class="divider border-left h-75 align-self-center mx-1"></div>


				        {{# output.search_box }}
				            {{{ output.search_box }}}
				            <div class="divider border-left h-75 align-self-center mx-1"></div>
				        {{/output.search_box}}
				        {{#langmenu}}
				            {{> theme_boost/language_menu }}
				            <div class="divider border-left h-75 align-self-center mx-1"></div>
				        {{/langmenu}}
				        {{{ output.navbar_plugin_output }}}
				        <div class="d-flex align-items-stretch usermenu-container" data-region="usermenu">
				            {{#usermenu}}
				                {{> core/user_menu }}
				            {{/usermenu}}
				        </div>
				        {{{ output.edit_switch }}}
				    </div>
				    
               </nav>
              

			</div><!--//top-bar-inner-->
		</div>
	</div><!--//top-bar-->
	
</header><!--//header-->


<div class="branding" >
	<div class="container-fluid">
		<div class="branding-inner">
            <div class="d-flex justify-content-between">
	        
		        <a href="{{{ config.wwwroot }}}" class="site-name {{# output.site_logo }}has-logo{{/ output.site_logo }}">
			        {{^ output.site_logo }}
			           {{{ sitename }}}
			        {{/ output.site_logo }}
			        
		            {{# output.site_logo }}
	
		                <img class="site-logo" src="{{{ output.site_logo }}}" alt="{{sitename}}">
	
		            {{/ output.site_logo }}
		        </a>
	            <div class="moremenu-wrapper navbar navbar-expand">
		            
		        <!-- custom_menu -->
	            {{#primarymoremenu}}
			        {{> core/moremenu }}
			    {{/primarymoremenu}}
	            </div><!--//moremenu-wrapper-->
   
	            <!-- page_heading_menu -->
	            {{{ output.page_heading_menu }}}
		       
	      
            </div><!--//d-flex-->
		   
		</div><!--//branding-inner-->
		
	</div><!--//container-fluid-->
</div><!--//branding-->

<script>

document.addEventListener('DOMContentLoaded', function () {
  const currentUrl = window.location.href;
  const urlParams = new URLSearchParams(currentUrl.split('?')[1]); // Get query parameters

  // Determine if the 'lang' parameter is present in the URL
  let currentLang = urlParams.get('lang');

  // If there's no 'lang' parameter, determine the default language from the browser settings
  if (!currentLang) {
    const browserLang = (navigator.language || navigator.userLanguage).toLowerCase(); // Browser's default language
    currentLang = browserLang.startsWith('en') ? 'en' :
                  browserLang.startsWith('fr') ? 'fr_ca' :
                  'en'; // Default to English if the browser language is ambiguous

    // Add 'lang' to the URL and force page reload
    const newUrl = currentUrl.includes('?')
      ? currentUrl + '&lang=' + currentLang
      : currentUrl + '?lang=' + currentLang;

    window.location.replace(newUrl); // Reload the page with the correct language
    return; // Exit early because the page will reload
  }

  // Set the document's language attribute
  document.documentElement.lang = currentLang;

  // Get the new URLs with updated language parameters
  const newHrefEn = currentUrl.replace(/lang=[^&]+/, 'lang=en');
  const newHrefFrCa = currentUrl.replace(/lang=[^&]+/, 'lang=fr_ca');
  const newHrefFr = currentUrl.replace(/lang=[^&]+/, 'lang=fr');

  // Get the link elements
  const dynamicLinkEn = document.getElementById('dynamic-link-en');
  const dynamicLinkFrCa = document.getElementById('dynamic-link-fr-ca');
  const dynamicLinkFr = document.getElementById('dynamic-link-fr');

  // Update the href attributes for language switching
  if (dynamicLinkEn) {
    dynamicLinkEn.href = newHrefEn;
  }
  if (dynamicLinkFrCa) {
    dynamicLinkFrCa.href = newHrefFrCa;
  }
  if (dynamicLinkFr) {
    dynamicLinkFr.href = newHrefFr;
  }

  // Function to add check marks
  function addCheckMark(element) {
    if (element) {
      element.innerHTML = '<strong>✔️</strong> ' + element.innerHTML.replace('<strong>✔️</strong> ', ''); 
    }
  }

  // Function to remove check marks
  function removeCheckMark(element) {
    if (element) {
      element.innerHTML.replace('<strong>✔️</strong> ', ''); // Ensure single check mark
    }
  }

  // Clear all check marks
  removeCheckMark(dynamicLinkEn);
  removeCheckMark(dynamicLinkFrCa);
  removeCheckMark(dynamicLinkFr);

  // Add a check mark based on the current language
  if (currentLang === 'en') {
    addCheckMark(dynamicLinkEn);
  } else if (currentLang === 'fr_ca') {
    addCheckMark(dynamicLinkFrCa);
  } else if (currentLang === 'fr') {
    addCheckMark(dynamicLinkFr);
  }
});



// Get the current language of the browser
const browserLang = navigator.language || navigator.userLanguage;

// Log the browser language to the console
console.log("Current browser language:", browserLang);


</script>


{{!--//moodle_validator (theme class function)--}}
{{{ output.moodle_validator}}} 

{{> theme_boost/primary-drawer-mobile }}

